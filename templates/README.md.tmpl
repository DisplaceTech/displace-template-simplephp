# {{.ProjectDisplayName}} PHP Site

**Generated by Displace CLI** - A simple PHP deployment on Kubernetes

## Project Overview

This project deploys a simple PHP website using:
- PHP-FPM for PHP processing
- Nginx for web serving
- Persistent storage for content
- TLS/HTTPS via cert-manager

## Quick Start

```bash
# Build the Docker image
make build

# Deploy to Kubernetes
make deploy

# Check status
make status

# Access locally
make port-forward
# Then visit http://localhost:8080
```

## Available Commands

Run `make help` to see all available commands:

| Command | Description |
|---------|-------------|
| `make deploy` | Deploy to Kubernetes with content sync |
| `make destroy` | Remove deployment from Kubernetes |
| `make status` | Check deployment status |
| `make logs` | View application logs |
| `make events` | View recent Kubernetes events |
| `make shell` | Access pod shell |
| `make port-forward` | Forward local port 8080 to service |
| `make open` | Open site in browser |
| `make build` | Build Docker image locally |
| `make dev` | Start local development with docker-compose |
| `make dev-down` | Stop local development |
| `make sync-content` | Sync local content to running pods |
| `make backup-content` | Backup content from pod |
| `make scale` | Scale replicas |
| `make validate` | Validate Kubernetes manifests |
| `make info` | Display project information |

## Content Management

### Development Workflow

Edit your PHP files locally and sync to running pods:

```bash
# Edit your content
vim public/index.php

# Sync to all running pods
make sync-content
```

### Local Development

Use docker-compose for local development:

```bash
# Start local server
make dev

# View logs
make dev-logs

# Stop server
make dev-down
```

## Project Structure

```
{{.ProjectName}}/
├── .credentials          # Project settings (git-ignored)
├── .gitignore
├── Dockerfile            # PHP-FPM + Nginx build
├── Makefile              # Project commands
├── README.md             # This file
├── docker-compose.yaml   # Local development
├── docker/
│   ├── nginx.conf        # Nginx configuration
│   ├── php.ini           # PHP configuration
│   └── supervisord.conf  # Process manager config
├── public/               # Your PHP files go here
│   └── index.php         # Main entry point
├── backups/              # Content backups
└── manifests/
    ├── 01-namespace.yaml
    ├── 02-content-pvc.yaml
    ├── 03-deployment.yaml
    ├── 04-service.yaml
    └── 05-ingress.yaml
```

## Configuration

Settings are stored in `.credentials`:

- `PROJECT_NAME` - Project identifier
- `NAMESPACE` - Kubernetes namespace
- `DOMAIN` - Site domain name
- `REGISTRY_URL` - Container registry (optional)
- `IMAGE_TAG` - Docker image tag

## PHP Configuration

Key PHP settings (configured in `docker/php.ini`):

- Memory limit: 128MB
- Max upload size: {{.UploadMaxSize}}
- OPcache enabled for production
- Error logging to stderr

## Scaling

Scale to multiple replicas:

```bash
make scale REPLICAS=3
```

## Cleanup

Remove the deployment:

```bash
make destroy
```

**Warning**: This permanently deletes all data.

---

**Generated by Displace CLI** - Making Kubernetes deployment simple and reliable.
